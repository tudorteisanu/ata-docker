(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["branches/edit5"],{"166a":function(t,e,n){},"3e5d":function(t,e,n){"use strict";n("b08f")},"604c":function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));n("4de4"),n("7db0"),n("c740"),n("4160"),n("caad"),n("c975"),n("fb6a"),n("a434"),n("a9e3"),n("2532"),n("159b");var a=n("5530"),i=(n("166a"),n("a452")),r=n("7560"),s=n("58df"),u=n("d9bd"),o=Object(s["a"])(i["a"],r["a"]).extend({name:"base-item-group",props:{activeClass:{type:String,default:"v-item--active"},mandatory:Boolean,max:{type:[Number,String],default:null},multiple:Boolean,tag:{type:String,default:"div"}},data:function(){return{internalLazyValue:void 0!==this.value?this.value:this.multiple?[]:void 0,items:[]}},computed:{classes:function(){return Object(a["a"])({"v-item-group":!0},this.themeClasses)},selectedIndex:function(){return this.selectedItem&&this.items.indexOf(this.selectedItem)||-1},selectedItem:function(){if(!this.multiple)return this.selectedItems[0]},selectedItems:function(){var t=this;return this.items.filter((function(e,n){return t.toggleMethod(t.getValue(e,n))}))},selectedValues:function(){return null==this.internalValue?[]:Array.isArray(this.internalValue)?this.internalValue:[this.internalValue]},toggleMethod:function(){var t=this;if(!this.multiple)return function(e){return t.internalValue===e};var e=this.internalValue;return Array.isArray(e)?function(t){return e.includes(t)}:function(){return!1}}},watch:{internalValue:"updateItemsState",items:"updateItemsState"},created:function(){this.multiple&&!Array.isArray(this.internalValue)&&Object(u["c"])("Model must be bound to an array if the multiple property is true.",this)},methods:{genData:function(){return{class:this.classes}},getValue:function(t,e){return null==t.value||""===t.value?e:t.value},onClick:function(t){this.updateInternalValue(this.getValue(t,this.items.indexOf(t)))},register:function(t){var e=this,n=this.items.push(t)-1;t.$on("change",(function(){return e.onClick(t)})),this.mandatory&&!this.selectedValues.length&&this.updateMandatory(),this.updateItem(t,n)},unregister:function(t){if(!this._isDestroyed){var e=this.items.indexOf(t),n=this.getValue(t,e);this.items.splice(e,1);var a=this.selectedValues.indexOf(n);if(!(a<0)){if(!this.mandatory)return this.updateInternalValue(n);this.multiple&&Array.isArray(this.internalValue)?this.internalValue=this.internalValue.filter((function(t){return t!==n})):this.internalValue=void 0,this.selectedItems.length||this.updateMandatory(!0)}}},updateItem:function(t,e){var n=this.getValue(t,e);t.isActive=this.toggleMethod(n)},updateItemsState:function(){var t=this;this.$nextTick((function(){if(t.mandatory&&!t.selectedItems.length)return t.updateMandatory();t.items.forEach(t.updateItem)}))},updateInternalValue:function(t){this.multiple?this.updateMultiple(t):this.updateSingle(t)},updateMandatory:function(t){if(this.items.length){var e=this.items.slice();t&&e.reverse();var n=e.find((function(t){return!t.disabled}));if(n){var a=this.items.indexOf(n);this.updateInternalValue(this.getValue(n,a))}}},updateMultiple:function(t){var e=Array.isArray(this.internalValue)?this.internalValue:[],n=e.slice(),a=n.findIndex((function(e){return e===t}));this.mandatory&&a>-1&&n.length-1<1||null!=this.max&&a<0&&n.length+1>this.max||(a>-1?n.splice(a,1):n.push(t),this.internalValue=n)},updateSingle:function(t){var e=t===this.internalValue;this.mandatory&&e||(this.internalValue=e?void 0:t)}},render:function(t){return t(this.tag,this.genData(),this.$slots.default)}});o.extend({name:"v-item-group",provide:function(){return{itemGroup:this}}})},7693:function(t,e,n){t.exports=n.p+"img/ru.47b9d7de.svg"},"796d":function(t,e,n){t.exports=n.p+"img/ro.b629e7a8.svg"},9569:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"fill-height d-flex justify-center"},[n("div",{staticClass:"content full-width"},[n("div",{staticClass:"text-h5 mb-sm-4 pa-4 pa-sm-0 primary--text"},[n("span",[t._v(" "+t._s(t.$t("document-templates.form.header.edit"))+" ")])]),n("v-card",{staticClass:"elevation-4 pa-4",attrs:{width:"100%"}},[n("v-card-text",{staticClass:"pa-0"},[n("div",{staticClass:"d-flex align-center font-weight-bold black-text--text px-5",staticStyle:{"font-size":"18px"}},[n("div",[n("span",[t._v(" "+t._s(t.$t("document-templates.headers.choose"))+" ")])]),n("div",{staticClass:"ml-3"},[n("v-tabs",{model:{value:t.currentTab,callback:function(e){t.currentTab=e},expression:"currentTab"}},t._l(t.flags,(function(e,a,i){return n("v-tab",{key:a,staticClass:"px-0",class:{"error-animation":t.missingKeys[i].length},staticStyle:{"min-width":"50px"}},[n("div",[n("v-img",{attrs:{width:"28px",src:e}})],1)])})),1)],1)]),n("v-form",{ref:"form",staticClass:"d-flex flex-column justify-center",attrs:{"lazy-validation":""}},[n("v-row",{staticClass:"mx-2"},[n("v-col",{attrs:{cols:"12"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:0===t.currentTab,expression:"currentTab === 0"}]},[n("div",[n("v-text-field",{attrs:{label:t.$t("document-templates.form.fields.subject"),"hide-details":""},model:{value:t.item.name_en,callback:function(e){t.$set(t.item,"name_en",e)},expression:"item.name_en"}})],1),n("div",{staticClass:"editor mt-3"},[n("textarea",{ref:"editor_en",staticClass:"full-width",attrs:{id:"editor_en"}})])]),n("div",{directives:[{name:"show",rawName:"v-show",value:1===t.currentTab,expression:"currentTab === 1"}]},[n("div",[n("v-text-field",{attrs:{label:t.$t("document-templates.form.fields.subject"),"hide-details":""},model:{value:t.item.name_ro,callback:function(e){t.$set(t.item,"name_ro",e)},expression:"item.name_ro"}})],1),n("div",{staticClass:"editor mt-3"},[n("textarea",{ref:"editor_ro",staticClass:"full-width",attrs:{id:"editor_ro"}})])]),n("div",{directives:[{name:"show",rawName:"v-show",value:2===t.currentTab,expression:"currentTab === 2"}]},[n("div",[n("v-text-field",{attrs:{label:t.$t("document-templates.form.fields.subject"),"hide-details":""},model:{value:t.item.name_ru,callback:function(e){t.$set(t.item,"name_ru",e)},expression:"item.name_ru"}})],1),n("div",{staticClass:"editor mt-3"},[n("textarea",{ref:"editor_ru",staticClass:"full-width",attrs:{id:"editor_ru"}})])])])],1),n("v-row",{staticClass:"actions"},[n("v-col",{staticClass:"pa-2 d-flex align-center"},[n("v-spacer"),n("v-btn",{attrs:{link:"",to:"/document-templates",disabled:t.loading,text:""}},[t._v(" "+t._s(t.$t("global-buttons.cancel"))+" ")]),n("v-btn",{staticClass:"ml-2",attrs:{color:"primary",disabled:t.loading,depressed:""},on:{click:t.submit}},[t._v(" "+t._s(t.$t("global-buttons.confirm"))+" ")])],1)],1)],1)],1)],1)],1)])},i=[],r=(n("caad"),n("c975"),n("a9e3"),n("2532"),n("2909")),s=n("b85c"),u=n("5530"),o=(n("96cf"),n("1da1")),l=n("2b0e"),c=n("366c"),d=n("0613"),f=n("5267"),h=n.n(f),m=n("a159"),v=n("a1dd"),g=n.n(v),b=n("982c"),p=n.n(b),x=(n("831f"),n("de5b")),_=l["a"].extend({name:"Edit",data:function(){return{requiredRule:x["i"],kothingConfig:m,item:{},editor_en:"",editor_ro:"",editor_ru:"",currentTab:0,userToSendEmailTo:null,languages:["en","ro","ru"],flags:{en:n("cffb"),ro:n("796d"),ru:n("7693")},subjects:{},editorRequirements:[[],[],[]],missingKeys:[[],[],[]],selects:{users:[]},errorMessages:{},loading:!1}},computed:{rules:function(){return{required:this.requiredRule.bind(this)}}},beforeRouteEnter:function(t,e,n){return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c["a"].documentTemplates().getForEdit(Number(t.params.id));case 3:return a=e.sent,e.next=6,c["a"].documentTemplates().getVariables();case 6:return i=e.sent,e.next=9,c["a"].users().getList();case 9:r=e.sent,n((function(t){t.getEditorsRequirements(i),t.item=a,t.selects.users=r})),e.next=17;break;case 13:return e.prev=13,e.t0=e["catch"](0),e.next=17,d["a"].dispatch("alert/showError",e.t0.message);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})))()},mounted:function(){this.createEditor(),this.setEditorsContent()},methods:{submit:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,t.setNewEditorContent(),e.next=5,c["a"].documentTemplates().edit(Number(t.$route.params.id),t.item);case 5:return e.next=7,t.$router.push("/document-templates");case 7:return e.next=9,t.$store.dispatch("alert/showSuccess",t.$t("document-templates.modals.alert.successful-edit"));case 9:e.next=17;break;case 11:return e.prev=11,e.t0=e["catch"](1),e.t0.hasOwnProperty("errors")&&(t.errorMessages=e.t0.errors,setTimeout((function(){t.errorMessages={}}),2e3)),e.next=16,t.$store.dispatch("alert/showError",e.t0.message);case 16:t.loading=!1;case 17:case"end":return e.stop()}}),e,null,[[1,11]])})))()},createEditor:function(){var t=this.$store.getters["localization/getCurrent"];this.editor_en=h.a.create("editor_en",Object(u["a"])({plugins:g.a,lang:p.a[t]},this.kothingConfig)),this.editor_ro=h.a.create("editor_ro",Object(u["a"])({plugins:g.a,lang:p.a[t]},this.kothingConfig)),this.editor_ru=h.a.create("editor_ru",Object(u["a"])({plugins:g.a,lang:p.a[t]},this.kothingConfig))},contains:function(t,e,n){var a,i=!0,r=Object(s["a"])(e);try{for(r.s();!(a=r.n()).done;){var u=a.value;t.includes(u)||(this.missingKeys[n].push(u),i=!1)}}catch(o){r.e(o)}finally{r.f()}return i},setEditorsContent:function(){var t,e=Object(s["a"])(this.languages);try{for(e.s();!(t=e.n()).done;){var n=t.value;this["editor_".concat(n)].setContents(this.item["content_".concat(n)]),this.subjects["".concat(n)]=this.item["name_".concat(n)]}}catch(a){e.e(a)}finally{e.f()}},setNewEditorContent:function(){var t,e=Object(s["a"])(this.languages);try{for(e.s();!(t=e.n()).done;){var n=t.value;this.item["content_".concat(n)]=this["editor_".concat(n)].getContents()}}catch(a){e.e(a)}finally{e.f()}},passedValidation:function(){var t=!0,e=0;this.missingKeys=[[],[],[]];var n,a=Object(s["a"])(this.languages);try{for(a.s();!(n=a.n()).done;){var i=n.value;this.contains(this["editor_".concat(i)].getContents(),this.editorRequirements[e],this.languages.indexOf(i))||(t=!1),e++}}catch(r){a.e(r)}finally{a.f()}return t},getEditorsRequirements:function(t){this.editorRequirements=[Object(r["a"])(t),Object(r["a"])(t),Object(r["a"])(t)]}}}),y=_,w=(n("3e5d"),n("2877")),V=n("6544"),C=n.n(V),O=n("8336"),j=n("b0af"),T=n("99d9"),E=n("62ad"),I=n("4bd4"),$=n("adda"),k=n("0fd9"),q=n("2fa4"),M=n("71a3"),X=n("fe57"),Y=n("8654"),S=Object(w["a"])(y,a,i,!1,null,"00f1c439",null);e["default"]=S.exports;C()(S,{VBtn:O["a"],VCard:j["a"],VCardText:T["c"],VCol:E["a"],VForm:I["a"],VImg:$["a"],VRow:k["a"],VSpacer:q["a"],VTab:M["a"],VTabs:X["a"],VTextField:Y["a"]})},"9d26":function(t,e,n){"use strict";var a=n("132d");e["a"]=a["a"]},afdd:function(t,e,n){"use strict";var a=n("8336");e["a"]=a["a"]},b08f:function(t,e,n){},c3f0:function(t,e,n){"use strict";n("4160"),n("159b");var a=n("80d2"),i=function(t){var e=t.touchstartX,n=t.touchendX,a=t.touchstartY,i=t.touchendY,r=.5,s=16;t.offsetX=n-e,t.offsetY=i-a,Math.abs(t.offsetY)<r*Math.abs(t.offsetX)&&(t.left&&n<e-s&&t.left(t),t.right&&n>e+s&&t.right(t)),Math.abs(t.offsetX)<r*Math.abs(t.offsetY)&&(t.up&&i<a-s&&t.up(t),t.down&&i>a+s&&t.down(t))};function r(t,e){var n=t.changedTouches[0];e.touchstartX=n.clientX,e.touchstartY=n.clientY,e.start&&e.start(Object.assign(t,e))}function s(t,e){var n=t.changedTouches[0];e.touchendX=n.clientX,e.touchendY=n.clientY,e.end&&e.end(Object.assign(t,e)),i(e)}function u(t,e){var n=t.changedTouches[0];e.touchmoveX=n.clientX,e.touchmoveY=n.clientY,e.move&&e.move(Object.assign(t,e))}function o(t){var e={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:t.left,right:t.right,up:t.up,down:t.down,start:t.start,move:t.move,end:t.end};return{touchstart:function(t){return r(t,e)},touchend:function(t){return s(t,e)},touchmove:function(t){return u(t,e)}}}function l(t,e,n){var i=e.value,r=i.parent?t.parentElement:t,s=i.options||{passive:!0};if(r){var u=o(e.value);r._touchHandlers=Object(r._touchHandlers),r._touchHandlers[n.context._uid]=u,Object(a["z"])(u).forEach((function(t){r.addEventListener(t,u[t],s)}))}}function c(t,e,n){var i=e.value.parent?t.parentElement:t;if(i&&i._touchHandlers){var r=i._touchHandlers[n.context._uid];Object(a["z"])(r).forEach((function(t){i.removeEventListener(t,r[t])})),delete i._touchHandlers[n.context._uid]}}var d={inserted:l,unbind:c};e["a"]=d},c740:function(t,e,n){"use strict";var a=n("23e7"),i=n("b727").findIndex,r=n("44d2"),s=n("ae40"),u="findIndex",o=!0,l=s(u);u in[]&&Array(1)[u]((function(){o=!1})),a({target:"Array",proto:!0,forced:o||!l},{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(u)},cffb:function(t,e,n){t.exports=n.p+"img/en.593a62e5.svg"},de5b:function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"g",(function(){return r})),n.d(e,"d",(function(){return s})),n.d(e,"i",(function(){return u})),n.d(e,"h",(function(){return o})),n.d(e,"e",(function(){return l})),n.d(e,"b",(function(){return c})),n.d(e,"f",(function(){return d}));n("13d5"),n("a9e3"),n("498a");var a=n("fe0b"),i=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?function(e){return!e||e.text.trim().length===t||a["a"].t("global-validation.exact",{number:t})}:function(e){return!e||(null===e||void 0===e?void 0:e.trim().length)===t||a["a"].t("global-validation.exact",{number:t})}},r=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?function(e){return!e||e&&e.length>=t||e&&e.text.length>=t||a["a"].t("global-validation.min",{number:t})}:function(e){return!e||e&&e.length>=t||a["a"].t("global-validation.min",{number:t})}},s=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?function(e){return!e||!e.text||e.text.length<=t||e.length<=t||a["a"].t("global-validation.max",{number:t})}:function(e){return!e||(null===e||void 0===e?void 0:e.length)<=t||a["a"].t("global-validation.max",{number:t})}},u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?function(e){return e&&e.hasOwnProperty("text")?!!e.text||a["a"].t("global-validation.required_field",{field:t}):!!e||a["a"].t("global-validation.required_field",{field:t})}:e?function(e){return!!e.text||a["a"].t("global-validation.required_field",{field:t})}:function(e){return!!e||a["a"].t("global-validation.required_field",{field:t})}},o=function(t){return function(e){return!e||Number(e)>=t||a["a"].t("global-validation.min_number",{number:t})}},l=function(t){return function(e){return!e||Number(e)<=t||a["a"].t("global-validation.max_number",{number:t})}},c=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=/^[^@]+@\w+(\.\w+)+\w$/;return e?!!t&&n.test(t.text)||a["a"].t("global-validation.email"):!t||n.test(t)||a["a"].t("global-validation.email")},d=function(t){return function(e){return!e||e.length>=t||a["a"].t("global-validation.min_count",{number:t})}},f=function(){return function(t){return!t||/.\../.test(t)||a["a"].t("global-validation.email")}},h=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t?function(t){return!t||/^[0-9,]*$/.test(t.text)||a["a"].t("global-validation.phone")}:function(t){return!t||/^[0-9,]*$/.test(t)||a["a"].t("global-validation.phone")}},m=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"value";return function(){return t.reduce((function(t,a){return a[n]===e?t+1:t}),0)<=1||a["a"].t("global-validation.unique")}},v=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"global-validation.is_equal";return function(n){return!n||t===n||a["a"].t(e)}};e["a"]={required:u,website:f,minCount:d,phone:h,email:c,minNumber:o,maxNumber:l,min:r,max:s,exact:i,unique:m,isEqualString:v}}}]);
//# sourceMappingURL=edit5.33b53dc5.js.map